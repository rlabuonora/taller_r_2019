<!DOCTYPE html>
<html>
  <head>
    <title>R, RStudio y el Tidyverse</title>
    <meta charset="utf-8">
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/remark-css/default-fonts.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# R, RStudio y el Tidyverse

---




## ¿Qué es R?

* Paquete estadístico (SPSS, STATA, Excel(?))
* Open Source
* Ecosistema de herramientas (RStudio, dplyr)

---

## ¿Por qué R?

* Análisis reproducible
* Ecosistema open source

---

## Ejemplo de eco sistema

* Stack Overflow
* Markdown
* Shiny

---
## Ejemplo de análisis reproducible

* Importar un csv
* Armar un reporte
* Algo de texto intercalado
* Tablas/Cruces
* Graficos
* Sale a pdf
* Cambiar un dato en el csv
* Volver a correr el reporte


---
## Scripts

* Es la clave para que el análisis sea reproducible
* Tiene costos fijos, pero no es tan difícil (este ejemplo lleva X líneas de código)
* Es más gratificante



---

## Rstudio

- Es una ambiente de desarrollo para R.

&lt;div align="center"&gt;
&lt;img src="imgs/Rstudio.png"&gt;
&lt;/div&gt;

---
- Tiene varias herramientas que nos facilitan la interacción con R:
  - Consola
  - Environment
  - Editor de texto
  - ...
---

## Consola

- Es la forma más básica de interactuar con R

&lt;div align="center"&gt;
&lt;img src="imgs/consola.png"&gt;
&lt;/div&gt;



```r
6*8
```

```
## [1] 48
```

```r
2^6
```

```
## [1] 64
```
  
* Arriba y abajo para scrollear los comandos

---
# Editor


&lt;div align="center"&gt;
&lt;img src="imgs/editor.png"&gt;
&lt;/div&gt;

---
# Ambiente

&lt;div align="center"&gt;
&lt;img src="imgs/environment.png"&gt;
&lt;/div&gt;

---
## Funciones predefinidas



```r
sqrt(2)
```

```
## [1] 1.414214
```

---
## Variables

* Sirven para almacenar resultados intermedios y organizar los programas:


```r
RaizDeDos &lt;- sqrt(2)
HorasPorAnio = 365 * 60
```

* En Excel y Stata no existen (!)

---
## Ambiente (environment)

* Es el conjunto de objetos disponibles a través de variables

```r
ls()
```

```
## [1] "HorasPorAnio" "RaizDeDos"
```

---
## Funciones definidas por usuarios

* Es el conjunto de objetos disponibles a través de variables:


```r
MyAbs &lt;- function(x) {
    if ( x &lt; 0 ) -x
    else x
}
MyAbs(-1)
```

```
## [1] 1
```

```r
MyAbs(2)
```

```
## [1] 2
```

---

## Data frames

Son similares a planillas de excel (tienen filas y columnas)

```r
who &lt;- read.csv("data/WHO.csv")
head(who$Country) # 
```

```
## [1] Afghanistan         Albania             Algeria            
## [4] Andorra             Angola              Antigua and Barbuda
## 194 Levels: Afghanistan Albania Algeria Andorra ... Zimbabwe
```

* `head` es una función que me muestra los primeros valores de un vector

```r
head(who$Country) 
```

```
## [1] Afghanistan         Albania             Algeria            
## [4] Andorra             Angola              Antigua and Barbuda
## 194 Levels: Afghanistan Albania Algeria Andorra ... Zimbabwe
```


---
## Importar archivos


```r
who &lt;- read.csv("data/WHO.csv")
# subset
who_euro &lt;- subset(who, Region=="Europe")
# salvar como csv
write.csv(who_euro, file="data/euro.csv")
```

---
##Info sobre el data frame


```r
nrow(who)
```

```
## [1] 194
```

```r
nrow(who_euro)
```

```
## [1] 53
```

```r
ncol(who)
```

```
## [1] 13
```

```r
names(who)
```

```
##  [1] "Country"                       "Region"                       
##  [3] "Population"                    "Under15"                      
##  [5] "Over60"                        "FertilityRate"                
##  [7] "LifeExpectancy"                "ChildMortality"               
##  [9] "CellularSubscribers"           "LiteracyRate"                 
## [11] "GNI"                           "PrimarySchoolEnrollmentMale"  
## [13] "PrimarySchoolEnrollmentFemale"
```


---
## Estadísticas descriptivas


```r
summary(who)
```

```
##                 Country                      Region     Population     
##  Afghanistan        :  1   Africa               :46   Min.   :      1  
##  Albania            :  1   Americas             :35   1st Qu.:   1696  
##  Algeria            :  1   Eastern Mediterranean:22   Median :   7790  
##  Andorra            :  1   Europe               :53   Mean   :  36360  
##  Angola             :  1   South-East Asia      :11   3rd Qu.:  24535  
##  Antigua and Barbuda:  1   Western Pacific      :27   Max.   :1390000  
##  (Other)            :188                                               
##     Under15          Over60      FertilityRate   LifeExpectancy 
##  Min.   :13.12   Min.   : 0.81   Min.   :1.260   Min.   :47.00  
##  1st Qu.:18.72   1st Qu.: 5.20   1st Qu.:1.835   1st Qu.:64.00  
##  Median :28.65   Median : 8.53   Median :2.400   Median :72.50  
##  Mean   :28.73   Mean   :11.16   Mean   :2.941   Mean   :70.01  
##  3rd Qu.:37.75   3rd Qu.:16.69   3rd Qu.:3.905   3rd Qu.:76.00  
##  Max.   :49.99   Max.   :31.92   Max.   :7.580   Max.   :83.00  
##                                  NA's   :11                     
##  ChildMortality    CellularSubscribers  LiteracyRate        GNI       
##  Min.   :  2.200   Min.   :  2.57      Min.   :31.10   Min.   :  340  
##  1st Qu.:  8.425   1st Qu.: 63.57      1st Qu.:71.60   1st Qu.: 2335  
##  Median : 18.600   Median : 97.75      Median :91.80   Median : 7870  
##  Mean   : 36.149   Mean   : 93.64      Mean   :83.71   Mean   :13321  
##  3rd Qu.: 55.975   3rd Qu.:120.81      3rd Qu.:97.85   3rd Qu.:17558  
##  Max.   :181.600   Max.   :196.41      Max.   :99.80   Max.   :86440  
##                    NA's   :10          NA's   :91      NA's   :32     
##  PrimarySchoolEnrollmentMale PrimarySchoolEnrollmentFemale
##  Min.   : 37.20              Min.   : 32.50               
##  1st Qu.: 87.70              1st Qu.: 87.30               
##  Median : 94.70              Median : 95.10               
##  Mean   : 90.85              Mean   : 89.63               
##  3rd Qu.: 98.10              3rd Qu.: 97.90               
##  Max.   :100.00              Max.   :100.00               
##  NA's   :93                  NA's   :93
```

---

## Vectores

* Son la base de los data frames (un data frame es una lista de vectores (?))
* Muchas funciones trabajan con vectores
* Para crear un vector de números uso la función *c*:


```r
vec &lt;- c(2, 3, 5, 8, 13)
vec
```

```
## [1]  2  3  5  8 13
```
- Accedo por el índice a cada componente

```r
vec[3]
```

```
## [1] 5
```

---

## Vectores (2)

* Pueden ser de texto

```r
counts &lt;- c("Brazil", "China", "India", "Switzerland", "USA")
life_exp&lt;- c(74, 76, 65, 83, 79)
```
* Para crear un data frame a partir de vectores:

```r
country_data &lt;- data.frame(counts, life_exp)
str(country_data)
```

```
## 'data.frame':	5 obs. of  2 variables:
##  $ counts  : Factor w/ 5 levels "Brazil","China",..: 1 2 3 4 5
##  $ life_exp: num  74 76 65 83 79
```

---
##Vectores (3) -Operador $

* El operador *$* me permite acceder a un item de una lista

```r
country_data$pop &lt;- c(199000, 1390000, 1240000, 7997, 318000)
str(country_data)
```

```
## 'data.frame':	5 obs. of  3 variables:
##  $ counts  : Factor w/ 5 levels "Brazil","China",..: 1 2 3 4 5
##  $ life_exp: num  74 76 65 83 79
##  $ pop     : num  199000 1390000 1240000 7997 318000
```
* ¡Cuidado con el orden!

---


## Visualización

- ¿Cuál es la relación entre el PIB y la tasa de fertilidad?

```r
plot(who$GNI, who$FertilityRate)
```

![](index_files/figure-html/unnamed-chunk-16-1.png)&lt;!-- --&gt;


---
## Subset

Hay dos países que no siguen la relacion negativa:

```r
outliers &lt;- subset(who, GNI &gt; 80000 | (FertilityRate &gt; 5 &amp; GNI &gt; 20000))
outliers[c("Country", "GNI", "FertilityRate")]
```

```
##               Country   GNI FertilityRate
## 56  Equatorial Guinea 25620          5.04
## 138             Qatar 86440          2.06
```


---
##Histogramas


```r
hist(who$CellularSubscribers)
```

![](index_files/figure-html/unnamed-chunk-18-1.png)&lt;!-- --&gt;


---
##Boxplots


```r
boxplot(who$LifeExpectancy ~ who$Region)
```

![](index_files/figure-html/unnamed-chunk-19-1.png)&lt;!-- --&gt;

```r
boxplot(who$LifeExpectancy ~ who$Region, xlab="", ylab="Life Expectancy", main="Life Expectancy by Region")
```

![](index_files/figure-html/unnamed-chunk-19-2.png)&lt;!-- --&gt;

---
##Importar funcionalidad

La función library permite importar "bibliotecas"


```r
## install.packages("readstata13")
library(readstata13)
writing &lt;- readstata13::read.dta13("data/writing.dta")
head(writing)
```

```
##   id preS preP preC preE postS postP postC postE
## 1  A   11    2    1    2    23     5     2     6
## 2  B    8    1    1    0     9     5     1     1
## 3  C   11    1    0    0    24     4     1     1
## 4  D    8    1    0    0    20     6     2     5
## 5  E    6    1    0    1    16     2     1     2
## 6  F    8    1    0    2    18     5     1     1
```


---
## Tidyverse

- Es un conjunto de librerías para tareas comunes en análisis de datos
- Es un dialecto de R


---


##`%&gt;%`

Sirve para combinar funciones y poder leerlas de izquierda a derecha.


```r
x %&gt;% f(y) 
#es equivalente a 
f(x,y)
```

---

##`%&gt;%` (2)

El nombre de los omnívoros que duermen más de 15 horas:


```r
select(filter(msleep, sleep_total &gt; 15), name)
```

```
## # A tibble: 12 x 1
##    name                          
##    &lt;chr&gt;                         
##  1 Owl monkey                    
##  2 Long-nosed armadillo          
##  3 North American Opossum        
##  4 Big brown bat                 
##  5 Thick-tailed opposum          
##  6 Little brown bat              
##  7 Tiger                         
##  8 Giant armadillo               
##  9 Arctic ground squirrel        
## 10 Golden-mantled ground squirrel
## 11 Eastern american chipmunk     
## 12 Tenrec
```

---

Es equivalente a:


```r
msleep %&gt;%
  filter(sleep_total &gt; 15) %&gt;%
  select(name)
```

```
## # A tibble: 12 x 1
##    name                          
##    &lt;chr&gt;                         
##  1 Owl monkey                    
##  2 Long-nosed armadillo          
##  3 North American Opossum        
##  4 Big brown bat                 
##  5 Thick-tailed opposum          
##  6 Little brown bat              
##  7 Tiger                         
##  8 Giant armadillo               
##  9 Arctic ground squirrel        
## 10 Golden-mantled ground squirrel
## 11 Eastern american chipmunk     
## 12 Tenrec
```
    </textarea>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function() {
  var d = document, s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})();</script>

<script>
(function() {
  var i, text, code, codes = document.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
})();
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
